\begin{figure*}
\begin{mathpar}
\infer [T-Var]
{ \inpropenv {\propenv{}} {\isprop {\t{}} {\x{}}} 
  \\\\
  {\thenprop {\prop{}}} = {\notprop {\Hashf{}} {\x{}}}
  \\
  {\elseprop {\prop{}}} = {\isprop {\Hashf{}} {\x{}}}
  \\\\
  {\prop{o}} = {\aliasprop {\v{}} {\x{}}}
}
{ \judgementtwo
  {\propenv{}} 
  {\hastype
    {\x{}} 
    {\refine 
      {\v{}} 
       {\t{}}
       {\andpropthree
         {\impprop
           {\notprop {\Hashf{}} {\v{}}}
           {\thenprop {\prop{}}}}
         {\impprop 
           {\isprop {\Hashf{}} {\v{}}}
           {\elseprop {\prop{}}}}
         {\prop{o}}}
 }}}

\infer [T-True]
{ {\thenprop {\prop{}}} = {\topprop{}}
  \\
  {\elseprop {\prop{}}} = {\botprop{}}
}
{ \judgementtwo {\propenv{}}
      {\hastype 
            {\hasht{}}
        {\refine 
          {\v{}} 
            {\Hasht{}}
             {\andprop 
               {\impprop
                 {\notprop {\Hashf{}} {\v{}}}
                 {\thenprop {\prop{}}}}
               {\impprop 
                 {\isprop {\Hashf{}} {\v{}}}
                 {\elseprop {\prop{}}}
         }}}}}

\infer [T-False]
{ {\thenprop {\prop{}}} = {\botprop{}}
  \\
  {\elseprop {\prop{}}} = {\topprop{}}
}
{ \judgementtwo {\propenv{}}
      {\hastype 
            {\hashf{}}
        {\refine 
          {\v{}} 
            {\Hashf{}}
             {\andprop 
               {\impprop
                 {\notprop {\Hashf{}} {\v{}}}
                 {\thenprop {\prop{}}}}
               {\impprop 
                 {\isprop {\Hashf{}} {\v{}}}
                 {\elseprop {\prop{}}}
         }}}}}

%\infer [T-Do]
%{ \judgementsevcol {\mmenv} {\taenv} {\propenv{}} {\hastype {\e1} {\t1}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop1}}} {\object{1}} {\mmenv{}} 
%\\\\
%\judgementsevcol {\mmenv{}}
%                  {\taenv}
%                   {\propenv{}, {\trdiff {\orprop {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}}}
%                   {\hastype {\e{}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} 
%                   {\object{}}
%                   {\mmenv{}}
%  }
%{ \judgementsevcol 
%  {\mmenv{}}
%  {\taenv{}}
%    {\propenv{}} {\hastype {\doexp {\e1} {\e{}}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} {\object{}} 
%       {\mmenv{}}
%             }

\infer [T-If]
{ \judgementtwo {\propenv{}}
                {\hastype {\e1} 
                  {\refine 
                    {\v{1}}
                    {\t{1}}
                    {\andprop
                      {\impprop
                      {\notprop {\Hashf{}} {\v{1}}} {\thenprop {\prop{1}}}}
                      {\impprop
                        {\isprop {\Hashf{}} {\v1}} {\elseprop {\prop{1}}}}}}}
             \\\\
  \judgementtwo {\propenv{}, {\thenprop {\prop{1}}}}
                {\hastype {\e{2}}
                  {\refine {\v2}
                    {\t{}}
                    {\andpropthree
                      {\impprop
                        {\notprop {\Hashf{}} {\v2}} {\thenprop {\prop{2}}}}
                      {\impprop
                        {\isprop {\Hashf{}} {\v2}} {\elseprop {\prop{2}}}}
                      {\aliasprop {\v{2}} {\object{}}}}}}
  \\\\
  \judgementtwo {\propenv{}, {\elseprop {\prop{1}}}}
                {\hastype {\e{3}}
                  {\refine {\v3}
                    {\t{}}
                    {\andpropthree
                      {\impprop
                        {\notprop {\Hashf{}} {\v3}} {\thenprop {\prop{3}}}}
                      {\impprop
                        {\isprop {\Hashf{}} {\v3}} {\elseprop {\prop{3}}}}
                  {\aliasprop {\v{3}} {\object{}}}}}}
   \\\\
   {\thenprop {\prop{}}} = {\orprop {\thenprop {\prop{2}}} {\thenprop {\prop{3}}}}
   \\
   {\elseprop {\prop{}}} = {\orprop {\elseprop {\prop{2}}} {\elseprop {\prop{3}}}}
             }
{ \judgementtwo {\propenv{}} 
  {\hastype {\ifexp {\e1} {\e2} {\e3}} 
            {\refine
              {v}
              {\t{}}
              {\andpropthree
                {\impprop
                  {\notprop {\Hashf{}} {v}}
                  {\thenprop {\prop{}}}}
                {\impprop 
                  {\isprop {\Hashf{}} {v}}
                  {\elseprop {\prop{}}}}
                {\aliasprop {\v{}} {\object{}}}}
          }}}

\infer [T-Abs]
{ 
    {\t{r}} = 
                 {\refine {\v{1}}
                          {\t{}}
                          {\andpropthree
                             {\impprop {\notprop {\Hashf{}} {v}}
                                       {\thenprop {\prop{}}}}
                             {\impprop {\isprop {\Hashf{}} {v}}
                                       {\elseprop {\prop{}}}}
                             {\aliasprop {\v{1}} {\object{}}}}}
                             \\\\
  \judgementtwo {\propenv{}, {\isprop {\s{}} {\x{}}}}
            {\hastype {\e{}} {\t{r}}}
          }
{ \judgementtwo {\propenv{}} 
    {\hastype {\abs {\x{}} {\s{}} {\e{}}}
      {\refine {\v{}}
               {\ArrowJustType {\x{}} {\s{}}
                 {\t{r}}}
               {\andprop {\impprop {\notprop {\Hashf{}} {v}}
                                   {\topprop{}}}
                         {\impprop {\isprop {\Hashf{}} {v}}
                   {\botprop{}}}}}}}

\infer [T-AppRef]
{ \judgementtwo {\propenv{}}
                {\hastype {\e{}}
                          {\ArrowJustType {\x{}} {\s{}}
                            {\refine {\v{2}}
                                     {\t{}}
                                     {\andpropthree {\impprop {\notprop {\Hashf{}} {\v{2}}} {\thenprop {\prop{f}}}}
                                                    {\impprop {\isprop {\Hashf{}} {\v{2}}} {\elseprop {\prop{f}}}}
                                                    {\aliasprop {\v{2}} {\object{f}}}}}}}
  \\\\
  \judgementtwo {\propenv{}}
                {\hastype {\ep{}} 
                  {\refine
                    {\v{3}}
                    {\s{}}
                    {\aliasprop {\v{3}} {\objectp{}}}}}
}
{ \judgementtwo {\propenv{}} 
    {\hastype {\appexp {\e{}} {\ep{}}}
          {\replacefor 
            {\refine
              {\v{}}
              {\t{}}
              {\andpropthree
                {\impprop
                  {\notprop {\Hashf{}} {\v{}}} {\thenprop {\prop{f}}}}
                {\impprop
                  {\isprop {\Hashf{}} {\v{}}} {\elseprop {\prop{f}}}}
                {\aliasprop {\v{}} {\object{f}}}}}
            {\objectp{}}
            {\x{}}}}
}






% DONT TOUCH
\infer [T-App]
{ \judgementfillcol {\propenv{}} {\hastype {\e{}} {\ArrowOne {\x{}} {\s{}}
                                                       {\t{}}
                                                       {\filterset {\thenprop {\prop{f}}}
                                                                   {\elseprop {\prop{f}}}}
                                                       {\object{f}}}}
                {\filterset {\thenprop {\prop{}}}
                            {\elseprop {\prop{}}}}
                {\object{}}
  \\\\
  \judgementfillcol {\propenv{}}
                 {\hastype {\ep{}} {\s{}}}
                 {\filterset {\thenprop {\propp{}}}
                             {\elseprop {\propp{}}}}
                 {\objectp{}} 
}
{ \judgementfillcol {\propenv{}} {\hastype {\appexp {\e{}} {\ep{}}}
                                        {\replacefor {\t{}}
                                                     {\objectp{}}
                                                     {\x{}}}}
                 {\replacefor {\filterset {\thenprop {\prop{f}}}
                                          {\elseprop {\prop{f}}}}
                              {\objectp{}}
                              {\x{}}}
                 {\replacefor {\object{f}}
                              {\objectp{}}
                              {\x{}}}
}

% invoke complete HMap with present key
\end{mathpar}
\caption{Typing Rules}
\end{figure*}
