\begin{figure*}
\begin{mathpar}
\infer [T-Var]
{ \inpropenv {\propenv{}} {\isprop {\t{}} {\x{}}} 
}
{ \judgementtwo
  {\propenv{}} 
  {\hastype
    {\x{}} 
    {\refinenotype
      {\v{}} 
      {\aliasprop {\v{}} {\x{}}}}}
 }

\infer [T-True]
{}
{ \judgementtwo {\propenv{}}
      {\hastype 
        {\hasht{}}
        {\Hasht{}}}}

\infer [T-False]
{}
{ \judgementtwo {\propenv{}}
      {\hastype 
        {\hashf{}}
        {\Hashf{}}
    }}

%\infer [T-Do]
%{ \judgementsevcol {\mmenv} {\taenv} {\propenv{}} {\hastype {\e1} {\t1}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop1}}} {\object{1}} {\mmenv{}} 
%\\\\
%\judgementsevcol {\mmenv{}}
%                  {\taenv}
%                   {\propenv{}, {\trdiff {\orprop {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}}}
%                   {\hastype {\e{}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} 
%                   {\object{}}
%                   {\mmenv{}}
%  }
%{ \judgementsevcol 
%  {\mmenv{}}
%  {\taenv{}}
%    {\propenv{}} {\hastype {\doexp {\e1} {\e{}}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} {\object{}} 
%       {\mmenv{}}
%             }

\infer [T-If]
{ \judgementtwo {\propenv{}}
                {\hastype {\e1}
                  {\refinenotype
                    {\v{1}}
                    {\prop{1}}}}
             \\\\
  \inpropenv {\prop{1}} {\aliasprop {\v{1}} {\object{}}}
  \\
  {\v{1}} \not= {\object{}}
             \\\\
  \judgementtwo {\propenv{}, {\replacefor {({\andprop {\notprop {\Hashf{}} {\v{1}}} {\prop{1} }})}{\object{}} {\v{1}}}}
                {\hastype {\e{2}}
                  {\t{}}}
             \\\\
  \judgementtwo {\propenv{}, {\replacefor {({\andprop {\isprop {\Hashf{}} {\v{1}}} {\prop{1} }})}{\object{}} {\v{1}}}}
                {\hastype {\e{3}}
                  {\t{}}}
             }
{ \judgementtwo {\propenv{}} 
  {\hastype {\ifexp {\e1} {\e2} {\e3}} 
            {\t{}}}}

%\infer [T-If]
%{ \judgementtwo {\propenv{}}
%                {\hastype {\e1} 
%                  {\refine 
%                    {\v{1}}
%                    {\t{1}}
%                    {\andprop
%                      {\impprop
%                      {\notprop {\Hashf{}} {\v{1}}} {\thenprop {\prop{1}}}}
%                      {\impprop
%                        {\isprop {\Hashf{}} {\v1}} {\elseprop {\prop{1}}}}}}}
%             \\\\
%  \judgementtwo {\propenv{}, {\thenprop {\prop{1}}}}
%                {\hastype {\e{2}}
%                  {\refine {\v2}
%                    {\t{}}
%                    {\andpropthree
%                      {\impprop
%                        {\notprop {\Hashf{}} {\v2}} {\thenprop {\prop{2}}}}
%                      {\impprop
%                        {\isprop {\Hashf{}} {\v2}} {\elseprop {\prop{2}}}}
%                      {\aliasprop {\v{2}} {\object{}}}}}}
%  \\\\
%  \judgementtwo {\propenv{}, {\elseprop {\prop{1}}}}
%                {\hastype {\e{3}}
%                  {\refine {\v3}
%                    {\t{}}
%                    {\andpropthree
%                      {\impprop
%                        {\notprop {\Hashf{}} {\v3}} {\thenprop {\prop{3}}}}
%                      {\impprop
%                        {\isprop {\Hashf{}} {\v3}} {\elseprop {\prop{3}}}}
%                  {\aliasprop {\v{3}} {\object{}}}}}}
%   \\\\
%   {\thenprop {\prop{}}} = {\orprop {\thenprop {\prop{2}}} {\thenprop {\prop{3}}}}
%   \\
%   {\elseprop {\prop{}}} = {\orprop {\elseprop {\prop{2}}} {\elseprop {\prop{3}}}}
%             }
%{ \judgementtwo {\propenv{}} 
%  {\hastype {\ifexp {\e1} {\e2} {\e3}} 
%            {\refine
%              {v}
%              {\t{}}
%              {\andpropthree
%                {\impprop
%                  {\notprop {\Hashf{}} {v}}
%                  {\thenprop {\prop{}}}}
%                {\impprop 
%                  {\isprop {\Hashf{}} {v}}
%                  {\elseprop {\prop{}}}}
%                {\aliasprop {\v{}} {\object{}}}}
%          }}}
%
%\infer [T-Abs]
%{ 
%    {\t{r}} = 
%                 {\refine {\v{1}}
%                          {\t{}}
%                          {\andpropthree
%                             {\impprop {\notprop {\Hashf{}} {v}}
%                                       {\thenprop {\prop{}}}}
%                             {\impprop {\isprop {\Hashf{}} {v}}
%                                       {\elseprop {\prop{}}}}
%                             {\aliasprop {\v{1}} {\object{}}}}}
%                             \\\\
%  \judgementtwo {\propenv{}, {\isprop {\s{}} {\x{}}}}
%            {\hastype {\e{}} {\t{r}}}
%          }
%{ \judgementtwo {\propenv{}} 
%    {\hastype {\abs {\x{}} {\s{}} {\e{}}}
%      {\refine {\v{}}
%               {\ArrowJustType {\x{}} {\s{}}
%                 {\t{r}}}
%               {\andprop {\impprop {\notprop {\Hashf{}} {v}}
%                                   {\topprop{}}}
%                         {\impprop {\isprop {\Hashf{}} {v}}
%                   {\botprop{}}}}}}}

\infer [T-App]
{ \judgementtwo {\propenv{}}
                {\hastype {\e{}}
                          {\ArrowJustType {\x{}}
                                          {\refinenotype {\v{1}} {\prop{1}}}
                                          {\t{}}
                            }}
  \\\\
  \judgementtwo {\propenv{}}
                {\hastype {\ep{}}
                          {\refinenotype {\v{2}} {\prop{2}}}}
             \\\\
  \inpropenv {\prop{1}} {\replacefor {\prop{2}} {\v{1}} {\v{2}}}
  \\\\
  \inpropenv {\prop{2}} {\aliasprop {\v{2}} {\object{}}}
  \\
  {\v{2}} \not= {\object{}}
}
{ \judgementtwo {\propenv{}}
    {\hastype {\appexp {\e{}} {\ep{}}}
          {\replacefor 
            {\t{}}
            {\object{}}
            {\x{}}}}
}

\infer [T-Subsume]
{ \judgementtwo {\propenv{}} {\hastype {\e{}} {\t{}}}
  \\
\inpropenv {} {\issubtype {\t{}} {\tp{}}}
}
{ \judgementtwo {\propenv{}} {\hastype {\e{}} {\tp{}}}
}

\infer [T-Let]
{ \judgementtwo {\propenv{}} 
             {\hastype {\e{1}} 
               {\refinenotype {\v{1}}
                              {\prop{1}}}}
  \\\\
  \judgementtwo{\propenv{}, {\replacefor {\prop{1}} {\x{}} {\v{1}}}}
               {\hastype {\e{}} {\t{}}}
             }
{ \judgementtwo {\propenv{}} 
      {\hastype {\letexp {\x{}} {\e{1}} {\e{}}}
                {\replacefor {\t{}} {\emptyobject{}} {\x{}}}}}

\infer [T-Cons]
{ \judgementtwo {\propenv{}} {\hastype {\e{1}} {\t{1}}}
  \\
  \judgementtwo {\propenv{}} {\hastype {\e{2}} {\t{2}}}
}
{ \judgementtwo {\propenv{}}
  {\hastype {\consexp {\e{1}} {\e{2}}} {\Cons {\t{1}} {\t{2}}}}
}

\infer [T-Car]
{ \judgementtwo {\propenv{}} 
        {\hastype {\e{}} 
          {\refinenotype {\v{1}} 
                         {\prop{1}}}}
  \\\\
  \inpropenv {\prop{1}} {\isprop{\Cons {\t{1}} {\t{2}}}{\v{1}}}
  \\\\
  \inpropenv {\prop{1}} {\aliasprop {\v{1}} {\object{}}}
  \\
  {\v{1}} \not= {\object{}}
}
{ \judgementtwo {\propenv{}}
  {\hastype {\carexp {\e{}}} 
    {\refinenotype
        {\v{}}
        {\replacefor
          {({\andprop
              {\prop{1}}
              {\aliasprop {\path {\carpe{}} {\v{1}}} {\v{}}}})}
          {\object{}}
          {\v{1}}}}}
}


\infer [T-Cdr]
{ \judgementtwo {\propenv{}} 
        {\hastype {\e{}} 
          {\refinenotype {\v{1}} 
                         {\prop{1}}}}
  \\\\
  \inpropenv {\prop{1}} {\isprop{\Cons {\t{1}} {\t{2}}}{\v{1}}}
  \\\\
  \inpropenv {\prop{1}} {\aliasprop {\v{1}} {\object{}}}
  \\
  {\v{1}} \not= {\object{}}
}
{ \judgementtwo {\propenv{}}
  {\hastype {\cdrexp {\e{}}} 
    {\refinenotype
        {\v{}}
        {\replacefor
          {({\andprop
              {\prop{1}}
              {\aliasprop {\path {\cdrpe{}} {\v{1}}} {\v{}}}})}
          {\object{}}
          {\v{1}}}}}
}

\infer [T-Abs]
{ \judgementtwo {\propenv{}, {\isprop {\s{}} {\x{}}}}
            {\hastype {\e{}} {\t{}}}}
{ \judgementtwo {\propenv{}} 
                {\hastype {\abs {\x{}} {\s{}} {\e{}}}
                          {\ArrowJustType {\x{}} {\s{}} {\t{}}}}
                                         }



\end{mathpar}
\caption{Typing Rules}
\end{figure*}
